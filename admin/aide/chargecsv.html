<!DOCTYPE html>
<html lang="fr">

<head>
    <meta charset="UTF-8">
    <title>Civil-Records | Aide</title>
    <link rel="shortcut icon" href="../../assets/img/favicon.ico" type="image/x-icon">
    <link media="screen" rel="stylesheet" href="./actes_aide.css" type="text/css">
</head>

<body>

    <h1> Charger des actes CSV : Format libre</h1>
    <p><a href="aide.html">Retour à la liste des fichiers d'aide</a></p>
    Cette option permet de <span style="font-weight: bold;">charger des actes encodés
        dans MS-Excel</span> ou dans OpenOffice (Classeur) en s'adaptant de façon
    très souple à la structure de votre fichier.
    <p>En général, les tableaux de dépouillements comportent
        en première ligne les noms des colonnes précisant le type d' information
        qui peut y être rangée. Par exemple, Nom, Prénom, Sexe,
        Nom du père, Nom de la mère, .... Ensuite dans les lignes suivantes
        se trouvent les informations dépouillées, un acte par ligne.</p>
    <p>Il convient de <strong>commencer par enregistrer la feuille au format CSV</strong>
        en prenant soin de choisir le point-virgule ou la tabulation pour séparer
        les champs. Autant que possible, il vaut mieux faire encadrer les champs par
        des guillemets. Ce n'est pas obligatoire sauf si les textes encodés comportent
        eux-mêmes des points-virgules.</p>
    <p>Il n'y a par contre pas de contrainte sur le nombre ou l'ordre des colonnes.
    </p>
    <p><img src="Extrait_csv.PNG" alt="Exemple de fichier à charger" width="686" height="84">
    </p>
    <p><em>Exemple de fichier à charger</em></p>
    <p>Le premier écran de chargement permet de sélectionner le fichier CSV
        à charger et préciser quelques paramètres de chargement. </p>
    <p><img src="chargeCSV_A.png" width="702" height="490"></p>
    <p><em>Exemple d'écran de chargement d'un fichier csv </em></p>
    <ul>
        <li>Sélectionner le type des actes;<br>
        </li>
        <li>Naviguer jusqu'au fichier CSV avec le bouton "Parcourir..." et le sélectionner;<br>
        </li>
        <li>Introduire les noms de la commune et du département qui vont être chargé. Si ces
            informations sont indiqués dans le fichier CSV lui-même, il est aussi possible de cocher la
            case en regard puis de préciser plus loin la colonne à utiliser pour ces données.
            <br>
        </li>
        <li>Introduire les nom des personnes qui ont collaboré à la mise en ligne de ces actes. Pour cela
            trois zones sont disponibles. Il est possible d'en modifier la dénomination et de déterminer
            dans quelle mesure elles seront affichées dans la fiche détaillée de l'acte en mode
            visiteur et/ou administrateur. Se reporter à la <a href="config.html#etiquettes">gestion des
                étiquettes</a> pour cette gestion.<br>
            Si les noms de ces personnes sont indiqués dans le fichier CSV lui-même, il est aussi possible
            de cocher la case en regard puis de préciser plus loin la colonne à utiliser pour ces
            données. <br>
        </li>
        <li>Cocher éventuellement une option de<strong> filtrage des données</strong> : </li>
        <li style="list-style: none">
            <ul>
                <li> <span style="font-style: italic;">éliminer les actes dont l'année est
                        incomplète</span>&nbsp;: Ne&nbsp;charge&nbsp;pas les actes pour lesquels l'année de
                    l'acte n'est pas complète (exemple : 17?? ou 0000 ou 165x) ; </li>
                <li> <span style="font-style: italic;">éliminer les actes ayant mêmes noms et prénoms
                    </span> : Elimine autant que possible les actes redondants c'est-à-dire ayant les mêmes
                    patronymes, les même prénoms et la même date d'acte. </li>
                <li> <span style="font-style: italic;">éliminer les actes dont le patronyme est vide </span> :
                    Elimine les actes qui n'ont aucune information dans la zone patronyme. <br>
                </li>
            </ul>
        </li>
        <li>Cocher selon les besoins les informations souhaitées pour le contrôle du chargement.
            L'affichage de ces informations ralenti le chargement mais facilite la détection et la recherche des
            anomalies éventuelles. Lorsqu'un n° est affiché entre parenthèses, il s'agit du
            n° de la ligne du fichier NIMEGUE qui cause le soucis.<br>
        </li>
        <li>Séléctionner le <strong>déposant</strong> : c'est en principe la personne qui effectue
            le chargement des actes. Cette option n'est disponible que pour les adminstrateurs qui peuvent charger des
            données pour plusieurs déposants. A partir de la version 3, cette mention est de moins
            d'importance car les trois zones Photographe, Transcripteur et Vérificateur offrent bien plus de
            facilités pour référencer les contributeurs. </li>
    </ul>
    <p>En cliquant sur le bouton &quot; <strong>&gt;&gt; CHARGER &gt;&gt;</strong> &quot; le fichier est
        téléchargé sur le serveur et y est
        stocké en vue de son exploitation ultérieure. </p>
    <p>L'écran présente alors un grand tableau permettant de décrire
        la façon d'associer les colonnes du fichier CSV (colonne de gauche du
        tableau) avec les zones de la base de données (colonne du milieu) en
        appliquant le cas échéant un &quot;traitement&quot; préalable
        (colonne de droite).</p>
    <p><img src="lecture_csv_1.PNG" alt="Exemple d'écran d'affectation de zones" width="642"
            height="525" border="1" /></p>
    <p><em>Exemple d'écran d'affectation de zones</em></p>
    <p>Dans la première colonne, chaque boîte de sélection contient
        la liste de toutes les colonnes du fichier CSV (présentes sur la première
        ligne du fichier). Lorsque cette ligne contient les descriptions des colonnes
        ce sont elles qui sont affichées (seulement les 13 premiers caractères
        si cette description est plus longue que 15 caractères). Si la première
        ligne contient déjà des données, ce sont ces dernières
        qui sont affichées.</p>
    <p>Pour chaque ligne, il suffit de sélectionner la colonne appropriée
        à la zone de la base de données ou de laisser le symbole tiret
        ( -- ) si rien ne doit être chargé. Il est tout à fait possible
        d'associer une même colonne avec plusieurs zones destination. Dans ce
        cas, un traitement approprié permettra de décomposer le contenu
        de cette colonne de façon adéquate.</p>
    <p>Lorsque chaque colonne est associée avec la zone voulue, il est possible
        de prévisualiser le résultat en cliquant que le bouton &quot;
        <strong>VOIR un exemple</strong> &quot;.
    </p>
    <p><img src="lecture_csv_2.PNG" alt="Affichage de la fiche exemple" width="637" height="357"></p>
    <p><em>Affichage de la fiche exemple (seconde ligne du fichier
            présenté plus haut)</em></p>
    <p>Chaque pression sur le bouton &quot; VOIR un exemple &quot; permet de prévisualiser
        la fiche suivante. </p>
    <p>Le tableau d'affectation des zones étant toujours affiché, il
        est possible de corriger ce qui est éventuellement nécessaire,
        puis de vérifier en affichant la fiche suivante.</p>
    <p>Lorsque les affectations sont correctes, il ne reste qu'à charger effectivement
        le fichier en pressant le bouton &quot; <strong>CHARGER maintenant</strong>
        &quot;. Le système passe le nombre de lignes annoncé en haut du
        tableau. Ordinairement, il faut passer une ligne pour ne pas charger les intitulés
        des colonnes.</p>
    <p>Si le fichier est très grand et/ou que le serveur est fort occupé,
        il se peut que le chargement ne puisse se terminer pendant le temps limite fixé
        par l'hébergeur. Dans ce cas, 3 secondes avant la fin du temps limite,
        le programme stoppe le chargement et affiche un écran permettant de continuer
        le travail sur la suite du fichier. De cette façon, il est possible de
        charger un gros fichier en plusieurs &quot;passes&quot; en cliquant simplement
        plusieurs fois sur le bouton &quot;Charger maintenant&quot;.</p>
    <p>Les associations entre colonnes et zones ainsi que les traitements sélectionnés
        sont mémorisés dans un cookie. De cette façon, lorsque
        l'on charge souvent des fichiers de même structure, l'association est
        immédiate. </p>
    <p>Le bouton &quot; <strong>Remise à blanc</strong> &quot; annule toutes
        les associations. Cette option est pratique lorsque le fichier à charger
        a un format très différent du précédent.</p>
    <h3>Utilisation d'un filtre</h3>
    <p>Dans certains cas, il peut être nécessaire de traiter un fichier
        en plusieurs passages car les lignes ne sont pas toutes codées de la
        même manière. Pour cela il convient de ne traiter que les lignes
        qui satisfont à une condition qui peut être exprimée avec
        le filtre. </p>
    <p><img src="filtre_csv.PNG" alt="Exemple de filtre pemettant de sélectionner les actes avec année révolutionnaire" width="626" height="212"></p>
    <p><em>Exemple de filtre permettant de sélectionner les
            actes avec année révolutionnaire.</em></p>
    <p>Pour qu'un filtre soit utilisé, il faut donc sélectionner
        la colonne sur laquelle porte la condition. Choisir ensuite le mode de comparaison
        et enfin indiquer le texte auquel il faut comparer sauf pour les condition &quot;n'est
        pas vide&quot; et &quot;est vide&quot; qui teste seulement si a colonne contient
        ou non des informations.</p>
    <p>Notons que la prévisualisation de fiche utilise également
        le filtre pour rechercher l'acte à afficher.</p>
    <h3>Liste des &quot;traitements&quot; possibles</h3>
    <p>Quatre catégories de &quot;traitements&quot; ont été définies
        selon la nature de la zone destination. De façon générale,
        chaque traitement permet de modifier le contenu de la colonne source en en extrayant
        une partie ou en regroupant son contenu avec celui d'une ou plusieurs colonnes
        suivantes. </p>

    <p>Chaque traitement est identifié dans la boite de sélection par
        un titre qui résume son action. Le symbole &quot;=&quot; signifie qu'aucun
        traitement n'est exécuté : le contenu de la colonne est affecté
        tel quel à la zone.</p>

    <p><strong><em>Traitement applicables aux zones contenant du texte</em></strong>
        (Nom, prénom, profession, origine, ...) </p>
    <blockquote>
        <dl>
            <dt>&quot;N&quot; si vide</dt>
            <dd>Ajoute le code &quot;N&quot; dans la zone si la colonne est vide. Ceci
                permet d'éviter d'avoir une zone vide pour le nom d'une personne.</dd>
            <dt>en Majuscules</dt>
            <dd>Transforme tout le texte de la colonne en majuscules. Utile pour les patronymes.</dd>
            <dt>1er mot seulement</dt>
            <dd>Ne garde que le premier mot (avant le premier espace)</dd>
            <dt>Sauf 1er mot</dt>
            <dd>Ne garde que ce qui suit le premier espace rencontré</dd>
            <dt>Dernier mot seulement</dt>
            <dd>Ne garde que ce qui suit le dernier espace blanc (ou tout le contenu s'il
                n'y a qu'un mot)</dd>
            <dt>Sauf dernier mot</dt>
            <dd>Début du texte jusqu'au dernier espace blanc (ou rien s'il n'y
                a qu'un mot)</dd>
            <dt>Début en majuscule</dt>
            <dd>Premiers mots écrits complètement en majuscules. Si les
                premiers mots ne sont pas en majuscules, il sont inclus également
                de façon à absorber les particules des patronymes. <br>
                <em>Exemples</em> : &quot;DELARUE André Marcel&quot; retourne &quot;DELARUE&quot;;
                &quot;de la RUE André&quot; retourne &quot;de la RUE&quot;; &quot;DE
                VILLERS DE DION Emile&quot; retourne &quot;DE VILLERS DE DION&quot; mais
                &quot;de VILLERS de DION Emile&quot; retournera &quot;de VILLERS&quot; puisque
                le mot suivant n'est pas complètement en minuscule.
            </dd>
            <dt>Fin en minuscule</dt>
            <dd>Complémentaire au précédent, retourne la partie qui
                suit le &quot;début en majuscule&quot;.</dd>
            <dt>Contenu parenthèses</dt>
            <dd>Recherche une parenthèse ouvrante et retourne le contenu jusqu'à
                la parenthèse fermante ou jusqu'à la fin s'il n'y en a pas.
                Les parenthèses ne sont pas conservées.<br>
                <em>Exemple</em> : &quot;Albert (Oncle)&quot; retourne &quot;Oncle&quot;.
            </dd>
            <dt>Sauf parenthèses </dt>
            <dd>Complémentaire au précédent, retourne ce qui est
                en dehors de la parenthèse, c'est-à-dire avant la première
                parenthèse ouvrante et après la 1ère parenthèse
                fermante.</dd>
            <dt>Avant la virgule</dt>
            <dd>Retourne le texte précédant la DERNIERE virgule de la chaîne.<br>
                <em>Exemple</em> : &quot;Albert, Emile, de Houdremont&quot; retourne &quot;Albert,
                Emile&quot;.
            </dd>
            <dt>Après la virgule</dt>
            <dd>Retourne le texte qui suit la DERNIERE virgule de la chaîne.<br>
                <em>Exemple</em> : &quot;Albert, Emile, de Houdremont&quot; retourne &quot;de
                Houdremont&quot;.
            </dd>
            <dt>Patronyme si pas vide</dt>
            <dd>Examine la colonne spécifiée et lorsque celle-ci contient
                bien un texte, retourne le patronyme de la première personne identifiée
                (typiquement le NOM du nouveau-né ou du défunt). Ce traitement
                permet de reconstituer le nom du père en recopiant celui du fils
                ou de la fille lorsque ce nom n'a pas été encodé.</dd>
            <dt>&quot;+&quot; si pas vide</dt>
            <dd>Ce traitement produit une croix, abréviation usuelle de &quot;décédé&quot;
                lorsque la colonne contient un code quelconque. Cela permet de par exemple
                de transformer une colonne &quot;Décédé&quot; dans
                laquelle on a indiqué des &quot;X&quot;.</dd>
            <dt>+ (x) col. suivante(s)</dt>
            <dd>Retourne le contenu complet de la colonne spécifiée suivi
                par le contenu des x colonnes suivantes. Les contenu des différentes
                colonnes sont séparés par des virgules. Ce traitement permet
                typiquement de regrouper plusieurs compléments d'informations dans
                une seule zone commentaire.</dd>
        </dl>
    </blockquote>
    <p><strong><em>Traitements spécifiques pour les zones &quot;SEXE&quot;</em>
        </strong>(sexe du nouveau-né, du défunt ou des intervenant d'un
        acte divers)</p>
    <blockquote>
        <dl>
            <dt>Toujours Masculin</dt>
            <dt>Toujours Féminin</dt>
            <dt>Inconnu</dt>
            <dd>Retourne selon le cas les valeurs constantes &quot;M&quot; , &quot;F&quot;
                ou &quot;?&quot;</dd>
            <dt>Selon 1er prénom</dt>
            <dd>Détecte le sexe (probable) en se basant sur le premier prénom
                (il faut indiquer la colonne contenant le prénom à examiner).
                Le système se base sur une liste de près de 200 prénoms
                féminins usuels (anciens) pour décider si le prénom
                est celui d'une homme ou d'une femme. </dd>
        </dl>
    </blockquote>
    <p><strong><em>Traitements spécifiques pour les zones &quot;AGE&quot;</em></strong>
        (&acirc;ge d'un défunt ou des conjoints d'un mariage)</p>
    <blockquote>
        <dl>
            <dt>Chiffres seulement</dt>
            <dd>Ne garde que les chiffres, points et virgules du texte présenté.</dd>
            <dt>Abrégé a m j </dt>
            <dd>Abrège le texte en remplaçant &quot;ans&quot; par &quot;a&quot;,
                &quot;mois&quot; par &quot;m&quot;, &quot;semaines&quot; par &quot;s&quot;
                et &quot;jours&quot; par &quot;j&quot;. Les blancs et virgules sont également
                supprimés.<br>
                <em>Exemple</em> : &quot;3 ans, 10 mois&quot; est remplacé par &quot;3a10m&quot;.
            </dd>
        </dl>
    </blockquote>
    <p><strong><em>Traitements spécifiques pour les zones &quot;DATE&quot;</em></strong>
        (date de l'acte et dates de naissance des intervenants)</p>
    <p>Le format &quot;naturel&quot; des dates est le format numérique formé
        par le numéro du jour, suivi du numéro du mois puis de celui
        de l'année. Ces numéros peuvent être séparés
        par un point, un tiret, un &quot;slash&quot; (/) ou encore un blanc. Exemple
        : 22.04.1619 ou 22-04-1619 ou 22/4/1619 ou encore 22 4 1619.<br>
        Si la date n'est pas dans ce format dans la colonne du fichier CSV, il convient
        de lui appliquer l'une des traitements suivants :</p>

    <blockquote>
        <dl>
            <dt>AAAA-MM-JJ</dt>
            <dd>C'est le format inversé en plaçant l'année d'abord,
                avant le mois puis le jour. En fait les séparateurs peuvent aussi
                être le point, le tiret, le slash ou le blanc et les numéros
                de jours ou de mois inférieurs à 10 peuvent ne compter qu'un
                seul chiffre.<br>
                <em>Exemple</em> : 1619-04-22 ou encore 1619/4/22
            </dd>
            <dt>JJMMAAAA</dt>
            <dd>Forme compacte de la date, il n'y a pas d'espace ou de signe séparateur.
                Les numéros de jours ou de mois inférieurs à 10 doivent
                être précédés d'un 0.<br>
                <em>Exemple</em> : 22041619.
            </dd>
            <dt>AAAAMMJJ</dt>
            <dd>Version inversée du format compact précédant.<br>
                <em>Exemple</em> : 16190422.
            </dd>
            <dt>JJMMMAAAA</dt>
            <dd>Dans cette forme compacte, le numéro du mois est remplacé
                par son abréviation française ou anglaise.<br>
                <em>Exemple</em> : 22AVR1619 ou 22APR1619.
            </dd>
            <dt>AAAAMMMJJ</dt>
            <dd>Version inversée du format précédant.<br>
                <em>Exemple</em> : 1619AVR22.
            </dd>
            <dt>3 col. JJ MM AAAA</dt>
            <dd>La date est ici éclatée en trois colonnes qui doivent être
                contigu&euml;s, la première indique le jour, la seconde le mois et
                la troisième l'année. Les numéros inférieurs
                à 10 peuvent comporter un seul chiffre ou être précédés
                du zéro. Dans le tableau d'affectation des zones, c'est toujours
                la première colonne qu'il faut indiquer.<br>
                <em>Exemple</em> : colonne 4 = &quot;22&quot;, colonne 5 = &quot;4&quot;,
                colonne 6 = &quot;1619&quot;, pointer vers la colonne 4.
            </dd>
            <dt>3 col. AAAA MM JJ</dt>
            <dd>Version inversée du format précédant.</dd>
            <dt>Dt. répub. 1 col.</dt>
            <dd>Date républicaine présentée dans une seule colonne.
                Le traitement retourne la date grégorienne correspondante. Le format
                de la date républicaine doit être formé par trois parties
                : d'abord le numéro du jour (de 1 à 30), ensuite le nom du
                mois (VENDémiaire, BRUmaire, ... FRUctidore et jours COMplémentaires),
                enfin l'année qui peut être précédée du
                mot &quot;an&quot; et être exprimée en chiffres arabes ou romains.<br>
                Les éléments doivent être séparés par
                des blancs, des tirets, des points ou des slashs.<br>
                <em>Exemples</em> : 3 fructdore an 7, 04 VEND XI, 3 COMP 6.
            </dd>
            <dt>Dt. répub. 3 col.</dt>
            <dd>Analogue au précédent mais avec les trois parties de la
                date dans trois colonnes consécutives.</dd>
            <dt>&nbsp;</dt>
        </dl>
    </blockquote>

    <p>Cette large batterie de fonctions de (pré-)traitement de l'information
        devrait faciliter la conversion de nombreuses données sans nécessité
        aucune manipulation des le tableur (Excel ou Open Office). </p>
    <p>Parfois, un simple "Rechercher - Remplacer" permettra d'adapter lighrement
        le format du fichier pour qu'il puisse utiliser l'un des traitements prédéfinis
        ici.</p>
    <p><em>Exemple</em> : Si la colonne prénom contient le lieu d'origine précédé
        du mot &quot;de&quot; (Albert de Montdru), il suffit de faire remplacer un remplacement
        automatique limité à la colonne concernée de &quot; de
        &quot; (précédé et suivi d'un blanc) par &quot; , &quot;.</p>
    <p><br>
        <a href="aide.html">Sommaire de l'aide</a>
    </p>
</body>

</html>